# This is a basic workflow to help you get started with Actions

name: CI

# Controls when the action will run. 
on:
  # Triggers the workflow on push or pull request events but only for the main branch
  push: 
    branches: [ main ]
  pull_request:
    branches: [ main ]
#    branches:    
#      - '*'         # matches every branch that doesn't contain a '/'
#      - '*/*'       # matches every branch containing a single '/'
#      - '**'        # matches every branch
#      - '!master'   # excludes master
#  push:
#    branches:
#    - '*'
#    - '!main'
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# Jobs section
jobs:
    # The job that will use the container image you just pushed to ghcr.io
    super-job:
        runs-on: ubuntu-18.04
        container:
            image: dkarnikis/test:latest
        steps:
            - name: super-step
              uses: actions/checkout@v2
            - name: pash
              shell: bash
              run: |
                pw=$PWD
                cd /pash/
                #git pull
                #git checkout top-level-tests
                #cd scripts
                #bash run_tests.sh
                #bash parse.sh > results.log 2>&1
                #cp results.log 

            - name: Add comment to PR
              env:
                #if: ${{ github.event_name == 'pull_request' }}
                gev: ${{ github.event_name }}
                URL: ${{ github.event.issue.comments_url }}
                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
              run: |
                echo $gev
                echo $URL
                echo $GITHUB_TOKEN
                curl \
                  -X POST \
                  $URL \
                  -H "Content-Type: application/json" \
                  -H "Authorization: token $GITHUB_TOKEN" \
                  --data '{ "body": "blah blah" }'
